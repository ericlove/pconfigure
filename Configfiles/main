LANGUAGES   += c
COMPILEOPTS += -Wall
COMPILEOPTS += -Wextra
COMPILEOPTS += -Werror
COMPILEOPTS += `pgcc-config gcc 4.5 gt -Wno-trampolines`
COMPILEOPTS += -Wno-unused-parameter
COMPILEOPTS += -std=gnu99
COMPILEOPTS += `pgcc-config gcc 4.3 lt -fnested-functions`

LANGUAGES   += bash

LANGUAGES   += pkgconfig
LINKOPTS    += -Sobj/proc/version-pc.sed

GENERATE    += version.h
GENERATE    += version-pc.sed

BINARIES    += pconfigure
LINKOPTS    += `pllvm-config --optional --have CLANG --libs`
COMPILEOPTS += `pllvm-config --optional --have CLANG --cflags`
LINKOPTS    += `ppkg-config  --optional --have TALLOC talloc --libs`
COMPILEOPTS += `ppkg-config  --optional --have TALLOC talloc --cflags`
COMPILEOPTS += -Isrc/extern/
DEPLIBS     += pinclude
SOURCES     += pconfigure/main.c
TESTSRC     += version.bash
TESTSRC     += simple-c.bash
TESTSRC     += tek.bash

BINARIES    += pclean
SOURCES	    += pclean.bash
TESTSRC     += simple.bash

BINARIES    += pbashc
COMPILEOPTS += -DLANG_BASH
SOURCES	    += pbashc.c
TESTSRC     += simple.bash
TESTSRC     += samedir.bash

BINARIES    += pperlc
COMPILEOPTS += -DLANG_PERL
SOURCES	    += pbashc.c
TESTSRC     += simple.bash
TESTSRC     += samedir.bash

BINARIES    += ppkg-config
SOURCES	    += ppkg-config.bash

BINARIES    += pgcc-config
SOURCES     += pgcc-config.bash

BINARIES    += pscalac
SOURCES	    += pscala/compiler.bash

BINARIES    += pscalald
SOURCES	    += pscala/linker.bash

BINARIES    += pnasm
SOURCES	    += pnasm.bash

BINARIES    += ptest
SOURCES	    += ptest.bash

LIBRARIES   += libpinclude.so
SOURCES     += libpinclude/library.c

LIBRARIES   += pkgconfig/pinclude.pc
LINKOPTS    += `ppkg-config --optional --have TALLOC talloc --pkgconfig`
SOURCES     += libpinclude/pinclude.pc

BINARIES    += pinclude
DEPLIBS     += pinclude
SOURCES     += pinclude.c
TESTSRC     += empty.bash
TESTSRC     += nonexist.bash
TESTSRC     += samedir.bash
TESTSRC     += samedir2.bash
TESTSRC     += indir.bash
TESTSRC     += existafter.bash

BINARIES    += pllvm-config
SOURCES     += pllvm-config.bash

BINARIES    += pwinegcc
SOURCES	    += pwinegcc.bash
